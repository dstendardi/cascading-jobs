/*
 * This build file was auto generated by running the Gradle 'buildSetup' task
 * by 'dstendardi' at 'Sat May 18 11:20:41 CEST 2013' with Gradle 1.6
 *
 * This generated file contains an out - commented sample java project
 * to get you started. For a quick start with Gradle have a look at the Java Quickstart
 * chapter in the Gradle Userguide available at /home/dstendardi/Applications/gradle-1.6/docs/userguide/tutorial_java_projects.html
 */


apply plugin:'java'
apply plugin: 'idea'
apply plugin: 'groovy'
apply plugin: 'maven'

sourceCompatibility = 1.6
targetCompatibility = 1.6

repositories{
  mavenLocal()
  mavenCentral()
  mavenRepo name: 'conjars', url: 'http://conjars.org/repo/'
  mavenRepo name: 'sonatype', url: 'http://oss.sonatype.org/content/groups/public/'

}

ext.cascadingVersion = '2.1.2'

configurations {
    cucumberRuntime {
        extendsFrom testRuntime
    }
}


dependencies{
    compile("org.apache.hadoop:hadoop-streaming:1.0.4")
    compile("org.apache.hadoop:hadoop-tools:1.0.4")

    // the production code uses the slf4j logging api at compile time
    compile 'org.slf4j:slf4j-api:1.7.5'
    compile 'cascading:cascading-core:'+ cascadingVersion 
    compile 'cascading:cascading-local:'+ cascadingVersion
    compile 'cascading:cascading-hadoop:'+ cascadingVersion

    compile 'org.apache.lucene:lucene-analyzers-common:4.3.0'

    cucumberRuntime files("${jar.archivePath}")

    testCompile 'org.codehaus.groovy:groovy-all:2.0.5'
    testCompile "junit:junit:4.11"
    testCompile "info.cukes:cucumber-junit:1.1.2"
    testCompile 'info.cukes:cucumber-groovy:1.1.2'
}

jar {
  description = "Assembles a Hadoop ready jar file"
  doFirst {
    into( 'lib' ) {
      from configurations.compile
    }
  }

  manifest {
    attributes( "Main-Class": "com.viadeo.cascading/Main" )
  }
}


task cucumber() {
    dependsOn assemble
    doLast {
        javaexec {
            main = "cucumber.api.cli.Main"
            classpath = configurations.cucumberRuntime
            args = ['-f', 'pretty', '--glue', 'src/test/groovy', 'src/test/resources']

        }
    }
}